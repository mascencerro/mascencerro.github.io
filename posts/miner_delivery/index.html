<!doctype html><html lang=en><head><title>Crypto-Miner Malware Delivery Analysis ::
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Discovery # A few weeks ago I was reworking a proof-of-concept exploit for a specific IoT device and while looking through the web service error log on the device, I noticed a few garbled mumbo-jumbo entries like in the following screenshot. These weren&amp;rsquo;t requests I had made to the device, but from another device (more than likely compromised) attempting to exploit a vulnerability and compromise the device I was working on."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://0x194.net/posts/miner_delivery/><link rel=stylesheet href=https://0x194.net/assets/style.css><link rel=stylesheet href=https://0x194.net/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://0x194.net/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://0x194.net/img/favicon.png><link href=https://0x194.net/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://0x194.net/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://0x194.net/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://0x194.net/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://0x194.net/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://0x194.net/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><meta name=twitter:card content="summary"><meta name=twitter:title content="Crypto-Miner Malware Delivery Analysis"><meta name=twitter:description content="Discovery # A few weeks ago I was reworking a proof-of-concept exploit for a specific IoT device and while looking through the web service error log on the device, I noticed a few garbled mumbo-jumbo entries like in the following screenshot. These weren&rsquo;t requests I had made to the device, but from another device (more than likely compromised) attempting to exploit a vulnerability and compromise the device I was working on."><meta property="og:url" content="https://0x194.net/posts/miner_delivery/"><meta property="og:site_name" content="0x194"><meta property="og:title" content="Crypto-Miner Malware Delivery Analysis"><meta property="og:description" content="Discovery # A few weeks ago I was reworking a proof-of-concept exploit for a specific IoT device and while looking through the web service error log on the device, I noticed a few garbled mumbo-jumbo entries like in the following screenshot. These weren&amp;rsquo;t requests I had made to the device, but from another device (more than likely compromised) attempting to exploit a vulnerability and compromise the device I was working on."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-04-17T11:52:05-05:00"><meta property="article:modified_time" content="2024-04-17T11:52:05-05:00"><meta property="article:tag" content="Iot"><meta property="article:tag" content="Malware"><meta property="article:tag" content="Crypto"><meta property="article:tag" content="Miner"><meta property="article:tag" content="Malware Delivery"><meta property="article:tag" content="Enumeration"></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span><span class=logo__text>mas@0x194:~ $</span>
<span class=logo__cursor></span>
</a><span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=/contact>Contact</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=/contact>Contact</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=post><h1 class=post-title>Crypto-Miner Malware Delivery Analysis</h1><div class=post-meta><span class=post-date>2024-04-17
</span><span class=post-read-time>— 9 min read</span></div><span class=post-tags><a href=https://0x194.net/tags/iot/>[iot]</a>&nbsp;
<a href=https://0x194.net/tags/malware/>[malware]</a>&nbsp;
<a href=https://0x194.net/tags/crypto/>[crypto]</a>&nbsp;
<a href=https://0x194.net/tags/miner/>[miner]</a>&nbsp;
<a href=https://0x194.net/tags/malware-delivery/>[malware delivery]</a>&nbsp;
<a href=https://0x194.net/tags/enumeration/>[enumeration]</a>&nbsp;</span><div class=post-content><h2 id=discovery>Discovery
<a href=#discovery class=h-anchor aria-hidden=true>#</a></h2><p>A few weeks ago I was reworking a proof-of-concept exploit for a specific IoT device and while looking through the web service error log on the device, I noticed a few garbled mumbo-jumbo entries like in the following screenshot. These weren&rsquo;t requests I had made to the device, but from another device (more than likely compromised) attempting to exploit a vulnerability and compromise the device I was working on. Seeing as the request is probably being made from a compromised victim device, I masked the specific requestor IP address just in case.</p><table><thead><tr><th style=text-align:center>Error log entry for invalid request</th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/error-log.png><img src=/img/miner_delivery/error-log.png></a></figure></td></tr></tbody></table><p>While at first glance this <em>appears</em> to make no sense, we can break down the request, see what it does, and enumerate the delivery mechanism of this specific malware.</p><p> </p><h2 id=breaking-it-down>Breaking it Down
<a href=#breaking-it-down class=h-anchor aria-hidden=true>#</a></h2><p>The first few segments of the log entry are just the request timestamp, entry type, process, etc. Basically nothing of relevance for what we&rsquo;re interested in. Next we can see that the log entry appears to have two <em>almost</em> identical requests. The first copy is the access error, and the second is the reason for access error (filesystem path).</p><table><thead><tr><th style=text-align:center>After trimming the fat and duplicate of the request we are left with the following:</th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/request.png><img src=/img/miner_delivery/request.png></a></figure></td></tr></tbody></table><p> </p><h3 id=compromising-the-machine>Compromising the Machine
<a href=#compromising-the-machine class=h-anchor aria-hidden=true>#</a></h3><ul><li><h4 id=vulnerability-and-initial-access>Vulnerability and Initial Access
<a href=#vulnerability-and-initial-access class=h-anchor aria-hidden=true>#</a></h4></li></ul><p>The first segment to look at is this part:</p><table><thead><tr><th style=text-align:center>Initial Exploit</th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/vulnerability.png><img src=/img/miner_delivery/vulnerability.png></a></figure></td></tr></tbody></table><p>Doing a quick Google search with that part returns information about <a href=https://nvd.nist.gov/vuln/detail/CVE-2022-26134>CVE-2022-26134</a> which <a href=https://nvd.nist.gov/vuln>NIST</a> describes it as:</p><blockquote><p>In affected versions of Confluence Server and Data Center, an OGNL injection vulnerability exists that would <strong>allow an unauthenticated attacker to execute arbitrary code</strong> on a Confluence Server or Data Center instance. The affected versions are from 1.3.0 before 7.4.17, from 7.13.0 before 7.13.7, from 7.14.0 before 7.14.3, from 7.15.0 before 7.15.2, from 7.16.0 before 7.16.4, from 7.17.0 before 7.17.4, and from 7.18.0 before 7.18.1.</p></blockquote><p><strong>&ldquo;allow an unauthenticated attacker to execute arbitrary code&rdquo;</strong> - This means with this the request could run commands on the target system <em>if vulnerable</em>. The device I was working with doesn&rsquo;t use Atlassian Confluence, so it hit a dead-end here. But given a server that <em>is</em> vulnerable, and a carefully tailored request, anyone could make the system run system commands.</p><p>Explanation of the specific vulnerability being exploited is beyond the scope of this writing, but there are articles and examples such as <a href=https://medium.com/@sivaramaaa/nashorn-script-engine-injection-eafc88a7623a>here</a> and <a href=https://darktrace.com/blog/detection-and-guidance-for-the-confluence-cve-2022-26134-zero-day>here</a>, and even a <a href=https://tryhackme.com/r/room/cve202226134>room at TryHackMe</a> that go more in depth for those interested.</p><p> </p><ul><li><h4 id=exploiting-and-execution>Exploiting and Execution
<a href=#exploiting-and-execution class=h-anchor aria-hidden=true>#</a></h4></li></ul><p>Next let&rsquo;s take a look and see exatly what commands it was trying to execute by analyzing the payload for <code>command()</code>:</p><table><thead><tr><th style=text-align:center>Exploit Payload</th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/request-payload-encoded.png><img src=/img/miner_delivery/request-payload-encoded.png></a></figure></td></tr></tbody></table><p>Wow, what is going on here?</p><p>What this contains is a list for the <code>java.lang.ProcessBuilder().command()</code> to process.</p><ul><li><code>bash</code> and <code>-c</code> tells it to interpret the following with the <code>bash</code> shell.</li><li><code>echo</code> a base64 encoded string and pipe to <code>base64 -d</code> to decode</li><li>pipe output of <code>base64 -d</code> to another <code>bash</code> to execute.</li></ul><p> </p><p>We will need to decode this string and see what it says in order to understand more. At this point all we can see is that it <code>echo</code> a seemingly random string of characters to be read by <code>base64</code> and executed after decoding.
Using either <code>base64 -d</code> command or <a href=https://gchq.github.io/CyberChef/>CyberChef</a> and decoding the string we get:</p><table><thead><tr><th style=text-align:center>Decoded Exploit Payload</th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/request-payload-decoded.png><img src=/img/miner_delivery/request-payload-decoded.png></a><figcaption class=center>payload decoded with <code>base64 -d</code></figcaption></figure></td></tr></tbody></table><p><strong>Now this is starting to look interesting.</strong></p><p>We have found what appears to be a script inteneded for execution on a victim system. Not all devices have the <code>curl</code> program, so relying on that binary to be on the system would potentially hinder the ability for this payload to function. Instead, what this script does is create its own function to use <code>/dev/tcp</code> for file transfer.</p><ul><li><h4 id=staging>Staging
<a href=#staging class=h-anchor aria-hidden=true>#</a></h4></li></ul><p>Once the initial payload is executed it downloads this new script <code>w.sh</code>:</p><table><thead><tr><th style=text-align:center>Stager Script <code>w.sh</code></th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/stager-init.png><img src=/img/miner_delivery/stager-init.png></a></figure></td></tr></tbody></table><p>Boiled down, this new script starts by assigning some variables for reference later in the script such as the path to <code>ls</code> and the domain and URL path for future downloads.
It then does the following:</p><ul><li><p>find the <code>chattr</code> binary and move it to <code>zzhcht</code> (installing e2fsprogs package if not found and possible)</p></li><li><p>set an environment variable for the new location of the renamed <code>chattr</code> binary</p></li><li><p>copies the <code>ls</code> binary to replace <code>chattr</code></p></li><li><p>sets attributes on the replaced <code>chattr</code> (originally <code>ls</code>) to ensure the changes aren&rsquo;t modified. As defined in the <code>chattr</code> manpage:</p><blockquote><p>a - A file with the &lsquo;a&rsquo; attribute set can only be opened in append mode for writing. Only the superuser or a process possessing the CAP_LINUX_IMMUTABLE capability can set or clear this attribute.</p><p>i - A file with the &lsquo;i&rsquo; attribute cannot be modified: it cannot be deleted or renamed, no link can be created to this file, most of the file&rsquo;s metadata can not be modified, and the file can not be opened in write mode. Only the superuser or a process possessing the CAP_LINUX_IMMUTABLE capability can set or clear this attribute.</p></blockquote></li><li><p>check if the current user ID is root and retrieve another script depending on result:</p><ul><li>if user is root download <code>ar.sh</code></li><li>if user <em>is not</em> root download <code>ai.sh</code></li></ul></li></ul><h3 id=setting-up-shop>Setting up Shop
<a href=#setting-up-shop class=h-anchor aria-hidden=true>#</a></h3><p>At this point in the exploit we&rsquo;re at a fork in the road. If the script has access as system administrator or <code>root</code> it has free reign of the system. But what if it only has normal user or unprivileged access? We will start by looking at it from a low-privileged user basis first and analyze the script.</p><ul><li><h4 id=unprivileged-system-access>Unprivileged System Access
<a href=#unprivileged-system-access class=h-anchor aria-hidden=true>#</a></h4></li></ul><table><thead><tr><th style=text-align:center>Unprivileged Script <code>ai.sh</code></th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/stager-unpriv.png><img src=/img/miner_delivery/stager-unpriv.png></a><figcaption class=center><code>proxyip</code> blurred because it may be another compromised device</figcaption></figure></td></tr></tbody></table><p>This script starts with setting some variables like <code>proxyip</code> and <code>media_url</code> as can be seen in the <a href=/img/miner_delivery/stager-unpriv.png>screenshot</a> above. It then sets up a <code>check_exists</code> function that checks that the system is not already communicating with the <code>proxyip</code> which would signal that that the miner is probably already running on this system.</p><p>After results from the <code>check_exists</code> function, the script continues to download the <code>media_url</code> and output to a file named <code>xm.jpg</code>. But if this file is a JPEG, why is it following up the download by running <code>tar</code>, <code>chmod</code>, and <code>./start</code>?</p><p>To get to the bottom of this we&rsquo;ll download and examine the file with <code>file</code> and see what it does contain.</p><table><thead><tr><th style=text-align:center>Reported File Type of <code>xm.jpg</code></th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/xm-jpg-file.png><img src=/img/miner_delivery/xm-jpg-file.png></a></figure></td></tr></tbody></table><p>Well, the <code>file</code> output explains the script running <code>tar</code> on the file after the download. It is a compressed TAR archive, not an actual JPEG.
For the next step we will list the contents of this tarball and see what it contains.</p><table><thead><tr><th style=text-align:center>List of Contents <code>xm.jpg</code></th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/xm-jpg-list.png><img src=/img/miner_delivery/xm-jpg-list.png></a></figure></td></tr></tbody></table><table><thead><tr><th style=text-align:center><code>xm.jpg</code> contents file information</th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/stager-unpriv-xm-files.png><img src=/img/miner_delivery/stager-unpriv-xm-files.png></a></figure></td></tr></tbody></table><p><strong>BINGO!</strong> we&rsquo;ve reached the plant.</p><p>The &lsquo;unprivileged&rsquo; branch of the script downloads the plant as a compressed TAR archive masking itself as a JPEG image, then unpacks the archive and makes the <code>start</code> binary found in the archive executable to continue by running <code>./start</code>.</p><p>The remaining files in the archive are for setting up the miner, the <a href=https://github.com/xmrig/xmrig>XMRig</a> miner binaries, and the <a href=https://github.com/chenkaie/junkcode/blob/master/xhide.c><code>hide</code></a> for <a href=https://flaviu.io/linux-how-to-a-hide-processes/>hiding the processes</a>.</p><ul><li><h4 id=privileged-system-access>Privileged System Access
<a href=#privileged-system-access class=h-anchor aria-hidden=true>#</a></h4></li></ul><p>This script is <strong>much</strong> longer than the unprivileged script (486 lines compared to 29) and has <em>a lot</em> going on, so we will dissect and analyze.</p><p>The first section to look at is the function calls at the bottom of the script. From there we will examine what the functions being called perform.</p><p>In the initialization there are variable assignments for <code>domain</code>, <code>mainurl</code>, <code>miner_url</code>, and <code>rshell_url</code> to be visited later in the functions. The function calls at the bottom of the script outlines the order the functions will be called in. We will follow this map to determine what the script is doing.</p><table><thead><tr><th style=text-align:center>Initialization</th><th style=text-align:center>Function Calls</th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/stager-priv-init.png><img src=/img/miner_delivery/stager-priv-init.png></a></figure></td><td style=text-align:center><figure class=center><a href=/img/miner_delivery/stager-priv-funccalls.png><img src=/img/miner_delivery/stager-priv-funccalls.png></a></figure></td></tr></tbody></table><p>Starting in the function call section of the script there is the <code>m_command()</code> function that checks the work from the initial stager script <code>w.sh</code> regarding <code>chattr</code>.</p><table><thead><tr><th style=text-align:center>m_command() function</th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/stager-priv-m_command.png><img src=/img/miner_delivery/stager-priv-m_command.png></a></figure></td></tr></tbody></table><p>The next functions called are <code>env_set()</code> and <code>clean_logs()</code>.</p><table><thead><tr><th style=text-align:center>env_set() function</th><th style=text-align:center>clean_logs() function</th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/stager-priv-env_set.png><img src=/img/miner_delivery/stager-priv-env_set.png></a></figure></td><td style=text-align:center><figure class=center><a href=/img/miner_delivery/stager-priv-clean_logs.png><img src=/img/miner_delivery/stager-priv-clean_logs.png></a></figure></td></tr></tbody></table><p>The <code>env_set()</code> function performs the following:</p><ul><li>disable firewall <code>firewalld</code></li><li>set maximum <code>ulimit</code> for resources (YOLO SEND IT!! mode)</li><li>sets some environment variables to take care of <code>history</code> and <code>PATH</code></li><li>disable SELINUX and the kernel watchdog (is the system taking to long to respond?)</li><li>set DNS resolver hosts to Google (8.8.8.8) and a Chinese DNS resolver 114DNS (114.114.114.114)</li><li>clear and takeover <code>crontab</code> just in case a system cron job tries to periodically interfere with the new operations</li></ul><p>Then the <code>clean_logs()</code> function does just as it says and iterates through the log files truncating each as an empty file.</p><p>Continuing through the function calls we find the <code>download_f()</code> function:</p><table><thead><tr><th style=text-align:center>download_f() function</th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/stager-priv-download_f.png><img src=/img/miner_delivery/stager-priv-download_f.png></a></figure></td></tr></tbody></table><p>This function creates the directory <code>/var/tmp/.11</code> if it doesn&rsquo;t already exist (<code>MOHOME</code> from the <a href=/img/miner_delivery/stager-priv-init.png>initialization</a>) and looks for the <code>sshd</code> binary at that location. If the <code>sshd</code> binary exists it will delete and download a new copy by retrieving the <code>enbash.tar</code> file from the URL stored in <code>miner_url</code>, storing it as <code>debash.tar</code> and extracting the contents. It then will check for a <code>bioset</code> binary in the same location and downloads that if needed by retrieving the <code>enbio.tar</code> file, storing it as <code>debio.tar</code> and extracting the contents.</p><table><thead><tr><th style=text-align:center><code>debash.tar</code></th><th style=text-align:center><code>debio.tar</code></th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/debash-tar-list.png><img src=/img/miner_delivery/debash-tar-list.png></a></figure></td><td style=text-align:center><figure class=center><a href=/img/miner_delivery/debio-tar-list.png><img src=/img/miner_delivery/debio-tar-list.png></a></figure></td></tr></tbody></table><table><thead><tr><th style=text-align:center><code>debash.tar</code> & <code>debio.tar</code> file information</th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/stager-priv-enbash_enbio-files.png><img src=/img/miner_delivery/stager-priv-enbash_enbio-files.png></a></figure></td></tr></tbody></table><p>Digging around I was able to find the <a href=https://github.com/arget13/DDexec/blob/main/ddexec.sh>bash.sh script</a> used for hiding processes as part of the <a href=https://github.com/arget13/DDexec>DDexec Github repository</a>.</p><p>Looking at the size and md5sum of the two miner binary files <code>aarch64</code> and <code>x86_64</code> from the &lsquo;unprivileged&rsquo; download file <code>xm.jpg</code> and comparing to the <code>sshd</code> binary from <code>enbash.tar</code> it is probably safe to assume the <code>sshd</code> binary is the miner binary.</p><table><thead><tr><th style=text-align:center>Binary Comparisons</th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/miner-size-md5sum.png><img src=/img/miner_delivery/miner-size-md5sum.png></a></figure></td></tr></tbody></table><p>The binary <code>bioset</code> from the <code>enbio.tar</code> appears to be the reverse shell utility <a href=https://github.com/WangYihang/Platypus>Platypus</a>.</p><p>The next functions called, <code>setup_s()</code> and <code>makesshaxx()</code>, proceed to set up the miner to appear as an SSH daemon and add keys to the <code>root</code> user for future access by the attacker.</p><table><thead><tr><th style=text-align:center>setup_s() function</th><th style=text-align:center>makesshaxx() function</th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/stager-priv-setup_s.png><img src=/img/miner_delivery/stager-priv-setup_s.png></a></figure></td><td style=text-align:center><figure class=center><a href=/img/miner_delivery/stager-priv-makesshaxx.png><img src=/img/miner_delivery/stager-priv-makesshaxx.png></a></figure></td></tr></tbody></table><p>Following the SSH daemon setup and access we will find the <code>ins_package()</code> function which installs build tools for compiling some future tooling and kernel module rootkit <a href=https://github.com/m0nad/Diamorphine>Diamorphine</a> from source as well as <code>net-tools</code> and <code>masscan</code> for providing network analysis and host discovery.</p><table><thead><tr><th style=text-align:center>ins_package() function</th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/stager-priv-ins_package.png><img src=/img/miner_delivery/stager-priv-ins_package.png></a></figure></td></tr></tbody></table><p>The next function <code>exec_hide2()</code> contains another large encoded string.</p><table><thead><tr><th style=text-align:center>exec_hide2() function</th></tr></thead><tbody><tr><td style=text-align:center><figure class=center><a href=/img/miner_delivery/stager-priv-exec_hide2.png><img src=/img/miner_delivery/stager-priv-exec_hide2.png></a></figure></td></tr></tbody></table><p>Decoding this string with <code>base64 -d</code> reveals the source for another process-hider, <a href=https://github.com/gianlucaborello/libprocesshider>libprocesshider</a>. The string is decoded in this function and binary compiled.</p><p> </p><hr><p>This was as far as I continued through my own dissection and analysis because during research into the <code>fkoths</code> binary contained in the <code>enbash.tar</code> file, I found an article written just over one month prior by researchers at <a href=https://cadosecurity.com>Cado Security</a> regarding this exact novel malware tooling. They do a <em><strong>much</strong></em> better job of explaining the remainder of the delivery and function in their article posted March 6, 2024 <a href=https://www.cadosecurity.com/blog/spinning-yarn-a-new-linux-malware-campaign-targets-docker-apache-hadoop-redis-and-confluence>Spinning YARN - A New Linux Malware Campaign Targets Docker, Apache Hadoop, Redis and Confluence</a>.</p><p>I have emailed Cado Security offering an archive of my findings that contain samples they mentioned not being able to retrieve, and hope to assist in what capacity I may.</p><p>Hopefully what I was able to cover in the delivery of this malware was informative, as I learned quite a bit through the researching of the scripts and locating the origins of some of the code and utilities used.</p></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button next"><a href=https://0x194.net/posts/merkury_smart_plug/><span class=button__text>Voiding the Warranty - Merkury Smart Plug</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span><span class=logo__text>mas@0x194:~ $</span>
<span class=logo__cursor></span></a><div class=copyright><span>© 2024 Powered by
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span>
<span>Theme created by
<a href=https://twitter.com/panr target=_blank rel=noopener>panr</a></span></div></div></footer><script src=https://0x194.net/assets/main.js></script><script src=https://0x194.net/assets/prism.js></script></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVGGCM9QQM"></script><script>var doNotTrack=!1,dnt;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-JVGGCM9QQM")}</script></body></html>